---
title: "Heat resistance test"
output: html_notebook
---


```{r setup, message=FALSE}
library(tidyverse, quietly = T)
library(cowplot, quietly = T)
library(here)
# set_here("../")

```


```{r read in data}
d <- read_csv(here("data","ssp_data.csv"))

```

```{r plot SPO1, message=FALSE}

d%>%
  filter(phage=="SPO1"|phage=="noPhage")%>%
  filter(grepl("group", group))%>%
  filter(!filter)%>%
  #there are 4 rows with data marked as "TMC" (=Too Many to Count) 
  # these are coerced into NA
  mutate(counts=as.numeric(counts ))%>%
  mutate(no.ml = counts/(dilution*ml.plated))%>%
  group_by(phage,assay)%>%
  ggplot(aes(x=heat.min, y=no.ml))+
    geom_line(aes(color=phage, linetype=assay))+
    geom_point(aes(color=phage, shape=assay), size=2, fill="white")+
  scale_y_log10()+
  scale_shape_manual(values = c(21,24))+
    facet_grid(group~host)+
  theme_cowplot()+
  panel_border()+
  ggtitle("SPO1")

```

```{r plot Goe2, message=FALSE}

d%>%
  filter(phage=="Goe2"|phage=="noPhage")%>%
  filter(grepl("group", group))%>%
  filter(!filter)%>%
  #there are 4 rows with data marked as "TMC" (=Too Many to Count) 
  # these are coerced into NA
  mutate(counts=as.numeric(counts ))%>%
  mutate(no.ml = counts/(dilution*ml.plated))%>%
  group_by(phage,assay)%>%
    ggplot(aes(x=heat.min, y=no.ml))+
    geom_line(aes(color=phage, linetype=assay))+
    geom_point(aes(color=phage, shape=assay), size=2, fill="white")+
  scale_y_log10()+
  scale_shape_manual(values = c(21,24))+
    facet_grid(group~host)+
  theme_cowplot()+
  panel_border()+
  ggtitle("Goe2")

```